{% extends 'template1/base.html' %}

{% block title %} Mapping{% endblock %}
{% block mapping %}

<div class="section type-2" style="padding:10px 0;">
    <div class="section-headlines" style="margin-bottom: 0px;">
    <h4 style="padding-bottom: 0px;margin-bottom: 0px;">Mapping</h4>
    </div>
</div>
<script src="../../static/scripts/d3.min.js"></script>
<script src="../../static/scripts/topojson.min.js"></script>
<script src="../../static/scripts/datamaps_world_min.js"></script>

<div class="container">
    <div class="row">
        <div class="col-lg-4 text-center ">
            <div class="border rounded p-3 m-0 list-group-item-action">
                <i class="fas fa-check h1"></i><br>
                Valid locations ratio : {{ converter.validLocationsRatio }}%
            </div>
        </div>
        <div class="col-lg-4 text-center">
            <div class="border rounded p-3 m-0 list-group-item-action">
                <i class="far fa-times-circle h1"></i><br>
                Unrecognized locations ratio : {{ converter.invalidLocationsRatio }}%
            </div>
        </div>
        <div class="col-lg-4 text-center">
            <div class="border rounded p-3 m-0 list-group-item-action">
                <i class="fas fa-question h1"></i><br>
                Unknown locations ratio: {{ converter.unknownLocationsRatio }}%
            </div>
        </div>
    </div>
</div>


<div id="container180" style="position: relative; margin:auto;height: 700px;"></div>
<script>
    var received_data  = {{ dataToSendToJs|safe }}
    var map = new Datamap({element: document.getElementById('container180'),
    fills: {

            HIGH: '#CB4335',
            LOW: '#5ac748',
            MEDIUM: '#2650c7',
            defaultFill: 'grey'
        },
        data: received_data,
        geographyConfig: {
        popupTemplate: function (geo, data) {
            return ['<div class="hoverinfo"><strong>',
                 geo.properties.name,
                ': ' + data.numberOfThings + ' tweet(s)',
                '</strong></div>'].join('');
        }
    }

    });
    // Draw a legend for this map

    map.legend();
</script>
</div>

    <br class="gap-70">
    <br class="gap-70">
    <br class="gap-70">
{% endblock %}